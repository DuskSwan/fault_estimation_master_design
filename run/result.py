import numpy as np
import pandas as pd

features = ['Sra', 'Max', 'Mean', 'Skewness', 'Peak2Peak', 'MarginFactor', 'Rmsf', 'ImpulseFactor', 'CrestFactor', 'Std', 'Var', 'Rvf', 'ShapeFactor', 'Min', 'Meanf', 'Kurtosis', 'Rms', 'KurtosisFactor']

def make_df(scores):
    df = pd.DataFrame([], columns=features)
    for score in scores:
        df = df._append(score, ignore_index=True)
    df.index = [str(i+1) for i in range(len(scores))]
    dfsum = df.sum(axis=0).rename('sum')
    df = df._append(dfsum)
    return df

def IMS_result():
    scores40 = {
        'Sra': 6.166927345581539,
        'Max': 5.70686309614711,
        'Mean': 5.704212085032383,
        'Skewness': 5.604351155744757,
        'Peak2Peak': 5.503402519476683,
        'MarginFactor': 5.193038415908451,
        'Rmsf': 5.094699073266847,
        'ImpulseFactor': 5.083100985203297,
        'CrestFactor': 4.923788201741599,
        'Std': 4.886003611130387,
        'Var': 4.871536140075175,
        'Rvf': 4.820501683808148,
        'ShapeFactor': 4.817463411175803,
        'Min': 4.768631617414087,
        'Meanf': 4.694468412364367,
        'Kurtosis': 4.686252844143767,
        'Rms': 4.45828949934542,
        'KurtosisFactor': 3.91696442448377,
    }
    scores30 = {
        'Rvf': 7.1616694185241165,
        'Skewness': 7.130705204784001,
        'Sra': 6.145443424555381,
        'Rmsf': 5.874267872118153,
        'ImpulseFactor': 5.803318294986028,
        'KurtosisFactor': 5.713444010642172,
        'CrestFactor': 5.60351506821506,
        'Rms': 5.585639565223307,
        'ShapeFactor': 5.533050053313175,
        'Min': 5.501831277296008,
        'MarginFactor': 5.481514434074075,
        'Mean': 4.95840665600698,
        'Kurtosis': 4.804701851831287,
        'Max': 4.664958993459736,
        'Var': 4.123802001654345,
        'Peak2Peak': 4.072774088304616,
        'Std': 3.9860993206825155,
        'Meanf': 3.5019223497351613,
    }
    scores31 = {
        'Rvf': 6.559042694083912,
        'Skewness': 6.262010336436749,
        'KurtosisFactor': 5.5828716104692315,
        'Sra': 5.553719359318157,
        'Peak2Peak': 5.506866788470886,
        'Meanf': 5.413027838651948,
        'Std': 5.322833916533289,
        'Mean': 5.238660943764803,
        'Rms': 5.223187673579507,
        'Var': 5.170290239081753,
        'MarginFactor': 5.167542240392,
        'Rmsf': 4.910721408369367,
        'Min': 4.906138178722749,
        'Kurtosis': 4.702651168746723,
        'ImpulseFactor': 4.533033556140227,
        'CrestFactor': 4.400525042890115,
        'Max': 4.3498252590906885,
        'ShapeFactor': 3.955810064569927,
    }
    scores41 = {
        'Kurtosis': 7.44551628290737,
        'Peak2Peak': 6.974054110281438,
        'Min': 6.510907962751325,
        'Max': 6.461331489202228,
        'KurtosisFactor': 6.231627479951252,
        'MarginFactor': 6.204849912470906,
        'ImpulseFactor': 6.1089180807398735,
        'CrestFactor': 6.058527766324821,
        'ShapeFactor': 6.025239433050229,
        'Sra': 5.567330014909285,
        'Std': 5.384328963087376,
        'Var': 5.355593865292732,
        'Rmsf': 5.195466189188595,
        'Rms': 5.11944595758775,
        'Meanf': 5.067799386240397,
        'Rvf': 5.045794937168331,
        'Skewness': 5.037309042042409,
        'Mean': 4.808893254648289,
    }
    scores42 = {
        'Skewness': 8.152084445294527,
        'CrestFactor': 6.478076600090167,
        'ImpulseFactor': 6.442986582882714,
        'MarginFactor': 6.430381510888534,
        'ShapeFactor': 6.283518807031096,
        'Min': 5.9658044245388275,
        'Sra': 5.776652948256841,
        'Meanf': 5.6367652641129045,
        'Rvf': 5.095000480091169,
        'Rms': 4.7832740177549065,
        'Mean': 4.767676955015795,
        'Rmsf': 4.577021313115668,
        'KurtosisFactor': 4.5695405220204535,
        'Max': 4.368906119656494,
        'Std': 4.208553966175554,
        'Var': 4.200841750998769,
        'Peak2Peak': 4.050071707461742,
        'Kurtosis': 3.969175563252785,
    }
    scores32 = {
        'Skewness': 8.032205866149202,
        'Rvf': 6.663613482391051,
        'Sra': 6.4254522977105,
        'KurtosisFactor': 6.1713847437312515,
        'ShapeFactor': 5.976822064908523,
        'ImpulseFactor': 5.8205754151879034,
        'MarginFactor': 5.625971988333938,
        'CrestFactor': 5.612162469110457,
        'Rmsf': 5.539105933163771,
        'Max': 5.413598473508224,
        'Peak2Peak': 5.405252506443274,
        'Rms': 5.256191170815667,
        'Kurtosis': 5.246722975848215,
        'Meanf': 4.98967287651598,
        'Min': 4.677230235936933,
        'Std': 4.554488200216957,
        'Var': 4.521600670810448,
        'Mean': 3.826296686319804,
    }
    scores33 = {
        'Rvf': 7.01467765592145,
        'Skewness': 6.418713869778001,
        'Kurtosis': 6.21417368067843,
        'ShapeFactor': 6.018291770759053,
        'Rmsf': 5.8918982216754205,
        'Rms': 5.795589819395472,
        'Peak2Peak': 5.658764022286631,
        'Sra': 5.609851739019186,
        'ImpulseFactor': 5.563919284205224,
        'KurtosisFactor': 5.557042049491583,
        'CrestFactor': 5.517121397368071,
        'Meanf': 5.4024198199911115,
        'MarginFactor': 5.276296606098187,
        'Min': 5.12813698470897,
        'Var': 5.119523270977873,
        'Std': 5.064223178602835,
        'Max': 4.958053020385279,
        'Mean': 4.058346573788603,
    }
    scores43 = {
        'Kurtosis': 7.70972631244997,
        'Peak2Peak': 7.660732890258959,
        'MarginFactor': 7.633495335362902,
        'ImpulseFactor': 7.514082206401193,
        'CrestFactor': 7.497155788101173,
        'ShapeFactor': 7.41279770770568,
        'Min': 7.218818952338712,
        'KurtosisFactor': 6.897151007788893,
        'Skewness': 6.388429118330498,
        'Sra': 5.743380985076624,
        'Std': 5.696035316809919,
        'Var': 5.6678857729274315,
        'Rmsf': 5.643122421340165,
        'Rms': 5.51523970276636,
        'Max': 5.383187943247259,
        'Rvf': 5.026331416666718,
        'Meanf': 4.824758326953464,
        'Mean': 4.637053786991405,
    }

    df3 = make_df([scores30, scores31, scores32, scores33])
    df4 = make_df([scores40, scores41, scores42, scores43])

    print('bearing3:\n',df3.loc['sum'].sort_values(ascending=False))
    print('bearing3:\n',df4.loc['sum'].sort_values(ascending=False))

def XJTU_result():
    scores11 = {'Kurtosis': 7.8072704636987025,
'CrestFactor': 7.690300003170081,
'ShapeFactor': 7.6876649956822405,
'ImpulseFactor': 7.555339720492416,
'MarginFactor': 7.521515297949725,
'Peak2Peak': 7.354374525224331,
'Min': 6.994537987902059,
'Max': 6.801644188919593,
'Rvf': 6.512329448549201,
'KurtosisFactor': 6.4099887598916405,
'Skewness': 6.398334703240069,
'Sra': 6.338492894674618,
'Meanf': 6.005383406051889,
'Std': 5.890837092034641,
'Rms': 5.885193615199614,
'Rmsf': 5.881690200968821,
'Var': 5.83012427463966,
'Mean': 5.76651342052659,}
    scores12 = {'Rms': 9.158539759757428,
'Std': 9.158214282834889,
'Rmsf': 9.156776334344212,
'Var': 9.148384101430132,
'Sra': 8.659566883671378,
'Meanf': 8.644961118523868,
'Peak2Peak': 8.386774445679375,
'Rvf': 8.14852323450693,
'Min': 7.907508655326634,
'KurtosisFactor': 7.784933771357617,
'ShapeFactor': 7.767357773053051,
'CrestFactor': 7.583574497579743,
'ImpulseFactor': 7.463758367320594,
'Kurtosis': 7.385334128764239,
'MarginFactor': 7.1422402049809754,
'Skewness': 6.985166960887942,
'Mean': 6.907035756206703,
'Max': 6.2069664569419025,}
    scores13 = {'KurtosisFactor': 9.259292889126165,
'Rvf': 8.821874005902025,
'Rmsf': 8.574748497584311,
'Rms': 8.573682267914158,
'Std': 8.572239713379046,
'Var': 8.54736740696646,
'MarginFactor': 8.406872753920975,
'Sra': 8.405687658966759,
'CrestFactor': 8.101975704700486,
'ImpulseFactor': 7.978510459207682,
'ShapeFactor': 7.786186588823448,
'Max': 7.2877364230344925,
'Min': 6.940716257248734,
'Peak2Peak': 6.902102875881212,
'Skewness': 6.897148477549025,
'Meanf': 6.865721155313652,
'Kurtosis': 6.8364434675635835,
'Mean': 6.654137945203313,}
    scores14 = {'Min': 8.214675261666603,
'CrestFactor': 8.2054365090304,
'Mean': 8.144381106193482,
'ShapeFactor': 8.042646425995073,
'ImpulseFactor': 7.857760852850525,
'Peak2Peak': 7.775374862543561,
'MarginFactor': 7.252267207966404,
'Meanf': 7.231461013314645,
'Sra': 6.886753592911333,
'Max': 6.867903023893905,
'Rmsf': 6.526390304642593,
'Rms': 6.520672057139468,
'Std': 6.5116203252031735,
'Var': 6.507163040247034,
'KurtosisFactor': 6.49370874085481,
'Rvf': 6.4245908388634465,
'Skewness': 6.149524189949867,
'Kurtosis': 5.784220014281217,}

    scores21 = {'Min': 8.415011775347795,
'Meanf': 7.871718882137555,
'Max': 7.69640349049925,
'Std': 7.592305921832383,
'Rms': 7.590739788256242,
'Rmsf': 7.588659670493888,
'Var': 7.581382651804679,
'Sra': 7.366287818090089,
'Rvf': 7.283906093476423,
'Mean': 7.278946048647024,
'Kurtosis': 7.273534585538203,
'KurtosisFactor': 7.267865736021923,
'Skewness': 7.207187454946409,
'MarginFactor': 7.127913144815666,
'Peak2Peak': 7.107757543029351,
'ImpulseFactor': 6.208181826019256,
'ShapeFactor': 6.200272326978312,
'CrestFactor': 6.0821728372752375,}
    scores22 = {'Skewness': 8.03199687126451,
'Max': 7.918548757718848,
'Sra': 7.689193873073135,
'Rvf': 7.257372981181881,
'KurtosisFactor': 7.250963184983951,
'Var': 7.155944544205845,
'Rmsf': 7.1209057883935785,
'Rms': 7.116572104309457,
'Std': 7.112130396259905,
'Meanf': 6.845962495440645,
'Mean': 6.724994998741375,
'Kurtosis': 6.347526609627374,
'Min': 5.851326703865809,
'MarginFactor': 5.688572976859769,
'Peak2Peak': 5.234094303147723,
'ShapeFactor': 5.043285347977136,
'ImpulseFactor': 4.957564725718765,
'CrestFactor': 4.715782115974851,}
    scores23 = {'Sra': 8.498951848974759,
'Var': 8.27765587526578,
'Rmsf': 8.187822613577058,
'Std': 8.18669022075612,
'Rms': 8.185353527785493,
'Rvf': 8.175232810616956,
'Min': 7.825246776207788,
'Peak2Peak': 7.511107346551481,
'Meanf': 7.184902307954397,
'Kurtosis': 7.180097041672086,
'Skewness': 6.933510014333736,
'KurtosisFactor': 6.658491533126431,
'MarginFactor': 6.580054044848367,
'Mean': 6.0910586354193414,
'ShapeFactor': 6.050556742190185,
'Max': 6.013136268568463,
'ImpulseFactor': 5.724858738832239,
'CrestFactor': 5.60874851082821,}
    scores24 = {'Sra': 8.169434728906648,
'Skewness': 8.082548717485967,
'KurtosisFactor': 7.926907767978662,
'Kurtosis': 7.8872216788600795,
'Rvf': 7.6007661189022535,
'Std': 7.381978230641266,
'Rmsf': 7.381950672946368,
'Rms': 7.381058630517817,
'Var': 7.334993620157377,
'Max': 7.00293159051806,
'Meanf': 6.816732790058245,
'Peak2Peak': 6.748499177440363,
'Mean': 6.641619890654086,
'MarginFactor': 6.408901014261437,
'Min': 6.283950888369432,
'ShapeFactor': 6.0692662654338605,
'ImpulseFactor': 5.799277760619125,
'CrestFactor': 5.556416595663166,}

    scores31 = {'Min': 7.979401562620891,
'Kurtosis': 7.603028623313122,
'Peak2Peak': 7.567081680860491,
'ImpulseFactor': 7.479928522001953,
'ShapeFactor': 7.461176720702545,
'Skewness': 7.380415603947863,
'CrestFactor': 7.3073568370143605,
'MarginFactor': 7.270729482658395,
'KurtosisFactor': 7.232670258424468,
'Mean': 7.1215704978922645,
'Rvf': 6.960923014260272,
'Meanf': 6.771600593683483,
'Std': 6.669150545131963,
'Rms': 6.643666206725648,
'Var': 6.6377943777499375,
'Rmsf': 6.617515820111336,
'Max': 6.584629909518302,
'Sra': 6.277939550754024,}
    scores32 = {'Skewness': 7.337768034715483,
'Meanf': 7.282228144020323,
'MarginFactor': 7.251779897999683,
'ShapeFactor': 7.189952646778541,
'ImpulseFactor': 7.186872036359654,
'Min': 7.083040984130794,
'CrestFactor': 7.01413338043392,
'Kurtosis': 6.636423551390543,
'Peak2Peak': 6.47430291454258,
'Sra': 6.410318177888737,
'Max': 6.201224588401965,
'Var': 6.11857438310353,
'KurtosisFactor': 6.082973555045355,
'Std': 6.062843397038962,
'Rms': 6.042032393848304,
'Rmsf': 6.017715557979991,
'Rvf': 5.92045133353173,
'Mean': 5.55982914292722,}
    scores33 = {'Min': 8.575040598162893,
'MarginFactor': 7.6964805310683015,
'Max': 7.5563539397588135,
'Peak2Peak': 7.339869907897594,
'CrestFactor': 7.0297770103601,
'ImpulseFactor': 7.019517947673631,
'Mean': 6.8923311609422875,
'ShapeFactor': 6.6819242121118645,
'Skewness': 6.579380817008419,
'Meanf': 6.499176705767021,
'Rvf': 6.267266847318851,
'Std': 6.027089163025558,
'Rms': 6.0180357099668225,
'Var': 6.0133089818068814,
'Rmsf': 6.004026030924189,
'Kurtosis': 5.974649896000202,
'KurtosisFactor': 5.960720674789576,
'Sra': 5.657391117495655,}
    scores34 = {'Mean': 7.817478178914703,
'Peak2Peak': 7.024311382430033,
'Kurtosis': 6.992384283288861,
'Skewness': 6.955208747513803,
'Max': 6.5275552523667475,
'Sra': 6.458868426326141,
'KurtosisFactor': 6.367153281964689,
'ShapeFactor': 6.325477749696219,
'MarginFactor': 6.311845009212329,
'CrestFactor': 6.284477575620631,
'ImpulseFactor': 6.28230715081037,
'Rvf': 6.169158556966243,
'Var': 6.142185260639884,
'Std': 6.135244354014188,
'Rms': 6.127850427983858,
'Min': 6.112849091295983,
'Rmsf': 6.10759110014534,
'Meanf': 5.993911823309814,}

    df1 = make_df([scores11, scores12, scores13, scores14])
    df2 = make_df([scores21, scores22, scores23, scores24])
    df3 = make_df([scores31, scores32, scores33, scores34])

    print('bearing1_1\n',df1.loc['sum'].sort_values(ascending=False))
    print('bearing1_2\n',df2.loc['sum'].sort_values(ascending=False))
    print('bearing1_3\n',df3.loc['sum'].sort_values(ascending=False))

if __name__ == '__main__':
    # IMS_result()
    XJTU_result()